<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/sameerasw/airsync/MainActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/sameerasw/airsync/MainActivity.kt" />
              <option name="originalContent" value="package com.sameerasw.airsync&#10;&#10;import android.os.Bundle&#10;import android.util.Log&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.unit.dp&#10;import com.sameerasw.airsync.ui.theme.AirSyncTheme&#10;import kotlinx.coroutines.Dispatchers&#10;import kotlinx.coroutines.launch&#10;import kotlinx.coroutines.withContext&#10;import java.io.BufferedReader&#10;import java.io.InputStreamReader&#10;import java.io.PrintWriter&#10;import java.net.Socket&#10;&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;&#10;        val data: android.net.Uri? = intent?.data&#10;        val ip = data?.host ?: &quot;192.168.1.100&quot;&#10;        val port = data?.port?.takeIf { it != -1 }?.toString() ?: &quot;6996&quot;&#10;&#10;        setContent {&#10;            AirSyncTheme {&#10;                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding -&gt;&#10;                    SocketTestScreen(&#10;                        modifier = Modifier.padding(innerPadding),&#10;                        initialIp = ip,&#10;                        initialPort = port&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun SocketTestScreen(&#10;    modifier: Modifier = Modifier,&#10;    initialIp: String = &quot;192.168.1.100&quot;,&#10;    initialPort: String = &quot;6996&quot;&#10;) {&#10;    var ipAddress by remember { mutableStateOf(initialIp) }&#10;    var port by remember { mutableStateOf(initialPort) }&#10;    var customMessage by remember { mutableStateOf(&quot;{\&quot;type\&quot;:\&quot;notification\&quot;,\&quot;data\&quot;:{\&quot;title\&quot;:\&quot;Test\&quot;,\&quot;body\&quot;:\&quot;Hello!\&quot;,\&quot;app\&quot;:\&quot;WhatsApp\&quot;}}&quot;) }&#10;    var response by remember { mutableStateOf(&quot;&quot;) }&#10;    var isLoading by remember { mutableStateOf(false) }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    fun send(message: String) {&#10;        scope.launch {&#10;            testSocket(ipAddress, port.toIntOrNull() ?: 6996, message) { result -&gt;&#10;                response = result&#10;                isLoading = false&#10;            }&#10;        }&#10;        isLoading = true&#10;        response = &quot;&quot;&#10;    }&#10;&#10;    Column(&#10;        modifier = modifier&#10;            .fillMaxSize()&#10;            .padding(16.dp),&#10;        horizontalAlignment = Alignment.CenterHorizontally,&#10;        verticalArrangement = Arrangement.spacedBy(16.dp)&#10;    ) {&#10;        Text(&quot;AirSync Tester&quot;, style = MaterialTheme.typography.headlineMedium)&#10;&#10;        OutlinedTextField(&#10;            value = ipAddress,&#10;            onValueChange = { ipAddress = it },&#10;            label = { Text(&quot;IP Address&quot;) },&#10;            modifier = Modifier.fillMaxWidth()&#10;        )&#10;&#10;        OutlinedTextField(&#10;            value = port,&#10;            onValueChange = { port = it },&#10;            label = { Text(&quot;Port&quot;) },&#10;            modifier = Modifier.fillMaxWidth()&#10;        )&#10;&#10;        Divider()&#10;&#10;        Button(&#10;            onClick = {&#10;                val message = &quot;&quot;&quot;{&quot;type&quot;:&quot;device&quot;,&quot;data&quot;:{&quot;name&quot;:&quot;Pixel 8 Pro&quot;,&quot;ipAddress&quot;:&quot;$ipAddress&quot;,&quot;port&quot;:${port.toIntOrNull() ?: 6996}}}&quot;&quot;&quot;&#10;                send(message)&#10;&#10;            },&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(&quot;Send Device Info&quot;)&#10;        }&#10;&#10;        Button(&#10;            onClick = {&#10;                val message = &quot;&quot;&quot;{&quot;type&quot;:&quot;notification&quot;,&quot;data&quot;:{&quot;title&quot;:&quot;Test Message&quot;,&quot;body&quot;:&quot;This is a simulated notification.&quot;,&quot;app&quot;:&quot;Telegram&quot;}}&quot;&quot;&quot;&#10;                send(message)&#10;&#10;            },&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(&quot;Send Notification&quot;)&#10;        }&#10;&#10;        Button(&#10;            onClick = {&#10;                val message = &quot;&quot;&quot;{&quot;type&quot;:&quot;status&quot;,&quot;data&quot;:{&quot;battery&quot;:{&quot;level&quot;:42,&quot;isCharging&quot;:false},&quot;isPaired&quot;:true,&quot;music&quot;:{&quot;isPlaying&quot;:true,&quot;title&quot;:&quot;Test Song&quot;,&quot;artist&quot;:&quot;Test Artist&quot;,&quot;volume&quot;:70,&quot;isMuted&quot;:false}}}&quot;&quot;&quot;&#10;                send(message)&#10;&#10;            },&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(&quot;Send Device Status&quot;)&#10;        }&#10;&#10;        Divider()&#10;&#10;        OutlinedTextField(&#10;            value = customMessage,&#10;            onValueChange = { customMessage = it },&#10;            label = { Text(&quot;Custom Raw JSON&quot;) },&#10;            modifier = Modifier.fillMaxWidth(),&#10;            maxLines = 4&#10;        )&#10;&#10;        Button(&#10;            onClick = { send(customMessage) },&#10;            enabled = !isLoading &amp;&amp; ipAddress.isNotBlank() &amp;&amp; port.isNotBlank() &amp;&amp; customMessage.isNotBlank(),&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            if (isLoading) {&#10;                CircularProgressIndicator(modifier = Modifier.size(16.dp), strokeWidth = 2.dp)&#10;                Spacer(modifier = Modifier.width(8.dp))&#10;            }&#10;            Text(if (isLoading) &quot;Sending...&quot; else &quot;Send Custom Message&quot;)&#10;        }&#10;&#10;        if (response.isNotEmpty()) {&#10;            Card(modifier = Modifier.fillMaxWidth()) {&#10;                Text(response, modifier = Modifier.padding(16.dp))&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;&#10;private suspend fun testSocket(ipAddress: String, port: Int, message: String, onResult: (String) -&gt; Unit) {&#10;    withContext(Dispatchers.IO) {&#10;        try {&#10;            val socket = Socket(ipAddress, port)&#10;            val output = PrintWriter(socket.getOutputStream(), true)&#10;            val input = BufferedReader(InputStreamReader(socket.getInputStream()))&#10;&#10;            output.println(message)&#10;            val response = input.readLine()&#10;            Log.d(&quot;TCP&quot;, &quot;Received: $response&quot;)&#10;&#10;            socket.close()&#10;&#10;            withContext(Dispatchers.Main) {&#10;                onResult(&quot;Success! Received: $response&quot;)&#10;            }&#10;        } catch (e: Exception) {&#10;            Log.e(&quot;TCP&quot;, &quot;Socket error: ${e.message}&quot;)&#10;            withContext(Dispatchers.Main) {&#10;                onResult(&quot;Error: ${e.message}&quot;)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Preview(showBackground = true)&#10;@Composable&#10;fun SocketTestPreview() {&#10;    AirSyncTheme {&#10;        SocketTestScreen()&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.sameerasw.airsync&#10;&#10;import android.os.Bundle&#10;import android.util.Log&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.window.Dialog&#10;import androidx.compose.ui.text.font.FontWeight&#10;import com.sameerasw.airsync.ui.theme.AirSyncTheme&#10;import kotlinx.coroutines.Dispatchers&#10;import kotlinx.coroutines.launch&#10;import kotlinx.coroutines.withContext&#10;import java.io.BufferedReader&#10;import java.io.InputStreamReader&#10;import java.io.PrintWriter&#10;import java.net.Socket&#10;&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;&#10;        val data: android.net.Uri? = intent?.data&#10;        val ip = data?.host ?: &quot;192.168.1.100&quot;&#10;        val port = data?.port?.takeIf { it != -1 }?.toString() ?: &quot;6996&quot;&#10;        val isFromQrScan = data != null&#10;&#10;        setContent {&#10;            AirSyncTheme {&#10;                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding -&gt;&#10;                    SocketTestScreen(&#10;                        modifier = Modifier.padding(innerPadding),&#10;                        initialIp = ip,&#10;                        initialPort = port,&#10;                        showConnectionDialog = isFromQrScan&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun SocketTestScreen(&#10;    modifier: Modifier = Modifier,&#10;    initialIp: String = &quot;192.168.1.100&quot;,&#10;    initialPort: String = &quot;6996&quot;,&#10;    showConnectionDialog: Boolean = false&#10;) {&#10;    var ipAddress by remember { mutableStateOf(initialIp) }&#10;    var port by remember { mutableStateOf(initialPort) }&#10;    var customMessage by remember { mutableStateOf(&quot;{\&quot;type\&quot;:\&quot;notification\&quot;,\&quot;data\&quot;:{\&quot;title\&quot;:\&quot;Test\&quot;,\&quot;body\&quot;:\&quot;Hello!\&quot;,\&quot;app\&quot;:\&quot;WhatsApp\&quot;}}&quot;) }&#10;    var response by remember { mutableStateOf(&quot;&quot;) }&#10;    var isLoading by remember { mutableStateOf(false) }&#10;    var isDialogVisible by remember { mutableStateOf(showConnectionDialog) }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    fun send(message: String) {&#10;        scope.launch {&#10;            testSocket(ipAddress, port.toIntOrNull() ?: 6996, message) { result -&gt;&#10;                response = result&#10;                isLoading = false&#10;            }&#10;        }&#10;        isLoading = true&#10;        response = &quot;&quot;&#10;    }&#10;&#10;    Column(&#10;        modifier = modifier&#10;            .fillMaxSize()&#10;            .padding(16.dp),&#10;        horizontalAlignment = Alignment.CenterHorizontally,&#10;        verticalArrangement = Arrangement.spacedBy(16.dp)&#10;    ) {&#10;        Text(&quot;AirSync Tester&quot;, style = MaterialTheme.typography.headlineMedium)&#10;&#10;        OutlinedTextField(&#10;            value = ipAddress,&#10;            onValueChange = { ipAddress = it },&#10;            label = { Text(&quot;IP Address&quot;) },&#10;            modifier = Modifier.fillMaxWidth()&#10;        )&#10;&#10;        OutlinedTextField(&#10;            value = port,&#10;            onValueChange = { port = it },&#10;            label = { Text(&quot;Port&quot;) },&#10;            modifier = Modifier.fillMaxWidth()&#10;        )&#10;&#10;        HorizontalDivider()&#10;&#10;        Button(&#10;            onClick = {&#10;                val message = &quot;&quot;&quot;{&quot;type&quot;:&quot;device&quot;,&quot;data&quot;:{&quot;name&quot;:&quot;Pixel 8 Pro&quot;,&quot;ipAddress&quot;:&quot;$ipAddress&quot;,&quot;port&quot;:${port.toIntOrNull() ?: 6996}}}&quot;&quot;&quot;&#10;                send(message)&#10;&#10;            },&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(&quot;Send Device Info&quot;)&#10;        }&#10;&#10;        Button(&#10;            onClick = {&#10;                val message = &quot;&quot;&quot;{&quot;type&quot;:&quot;notification&quot;,&quot;data&quot;:{&quot;title&quot;:&quot;Test Message&quot;,&quot;body&quot;:&quot;This is a simulated notification.&quot;,&quot;app&quot;:&quot;Telegram&quot;}}&quot;&quot;&quot;&#10;                send(message)&#10;&#10;            },&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(&quot;Send Notification&quot;)&#10;        }&#10;&#10;        Button(&#10;            onClick = {&#10;                val message = &quot;&quot;&quot;{&quot;type&quot;:&quot;status&quot;,&quot;data&quot;:{&quot;battery&quot;:{&quot;level&quot;:42,&quot;isCharging&quot;:false},&quot;isPaired&quot;:true,&quot;music&quot;:{&quot;isPlaying&quot;:true,&quot;title&quot;:&quot;Test Song&quot;,&quot;artist&quot;:&quot;Test Artist&quot;,&quot;volume&quot;:70,&quot;isMuted&quot;:false}}}&quot;&quot;&quot;&#10;                send(message)&#10;&#10;            },&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(&quot;Send Device Status&quot;)&#10;        }&#10;&#10;        HorizontalDivider()&#10;&#10;        OutlinedTextField(&#10;            value = customMessage,&#10;            onValueChange = { customMessage = it },&#10;            label = { Text(&quot;Custom Raw JSON&quot;) },&#10;            modifier = Modifier.fillMaxWidth(),&#10;            maxLines = 4&#10;        )&#10;&#10;        Button(&#10;            onClick = { send(customMessage) },&#10;            enabled = !isLoading &amp;&amp; ipAddress.isNotBlank() &amp;&amp; port.isNotBlank() &amp;&amp; customMessage.isNotBlank(),&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            if (isLoading) {&#10;                CircularProgressIndicator(modifier = Modifier.size(16.dp), strokeWidth = 2.dp)&#10;                Spacer(modifier = Modifier.width(8.dp))&#10;            }&#10;            Text(if (isLoading) &quot;Sending...&quot; else &quot;Send Custom Message&quot;)&#10;        }&#10;&#10;        if (response.isNotEmpty()) {&#10;            Card(modifier = Modifier.fillMaxWidth()) {&#10;                Text(response, modifier = Modifier.padding(16.dp))&#10;            }&#10;        }&#10;&#10;        if (isDialogVisible) {&#10;            ConnectionDialog(&#10;                ipAddress = ipAddress,&#10;                port = port,&#10;                onDismiss = { isDialogVisible = false },&#10;                onConnect = {&#10;                    isDialogVisible = false&#10;                    // Send device info automatically&#10;                    val message = &quot;&quot;&quot;{&quot;type&quot;:&quot;device&quot;,&quot;data&quot;:{&quot;name&quot;:&quot;Pixel 8 Pro&quot;,&quot;ipAddress&quot;:&quot;$ipAddress&quot;,&quot;port&quot;:${port.toIntOrNull() ?: 6996}}}&quot;&quot;&quot;&#10;                    send(message)&#10;                }&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ConnectionDialog(&#10;    ipAddress: String,&#10;    port: String,&#10;    onDismiss: () -&gt; Unit,&#10;    onConnect: () -&gt; Unit&#10;) {&#10;    Dialog(onDismissRequest = onDismiss) {&#10;        Surface(&#10;            shape = MaterialTheme.shapes.medium,&#10;            tonalElevation = 3.dp&#10;        ) {&#10;            Column(&#10;                modifier = Modifier&#10;                    .padding(24.dp)&#10;                    .width(280.dp),&#10;                verticalArrangement = Arrangement.spacedBy(16.dp)&#10;            ) {&#10;                Text(&#10;                    text = &quot;Connect to Desktop?&quot;,&#10;                    style = MaterialTheme.typography.titleMedium.copy(fontWeight = FontWeight.Bold)&#10;                )&#10;&#10;                Text(&quot;Do you want to connect to:&quot;)&#10;                Text(&quot;IP Address: $ipAddress&quot;)&#10;                Text(&quot;Port: $port&quot;)&#10;&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                ) {&#10;                    OutlinedButton(&#10;                        onClick = onDismiss,&#10;                        modifier = Modifier.weight(1f)&#10;                    ) {&#10;                        Text(&quot;Cancel&quot;)&#10;                    }&#10;                    &#10;                    Button(&#10;                        onClick = onConnect,&#10;                        modifier = Modifier.weight(1f)&#10;                    ) {&#10;                        Text(&quot;Connect&quot;)&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;private suspend fun testSocket(ipAddress: String, port: Int, message: String, onResult: (String) -&gt; Unit) {&#10;    withContext(Dispatchers.IO) {&#10;        try {&#10;            val socket = Socket(ipAddress, port)&#10;            val output = PrintWriter(socket.getOutputStream(), true)&#10;            val input = BufferedReader(InputStreamReader(socket.getInputStream()))&#10;&#10;            output.println(message)&#10;            val response = input.readLine()&#10;            Log.d(&quot;TCP&quot;, &quot;Received: $response&quot;)&#10;&#10;            socket.close()&#10;&#10;            withContext(Dispatchers.Main) {&#10;                onResult(&quot;Success! Received: $response&quot;)&#10;            }&#10;        } catch (e: Exception) {&#10;            Log.e(&quot;TCP&quot;, &quot;Socket error: ${e.message}&quot;)&#10;            withContext(Dispatchers.Main) {&#10;                onResult(&quot;Error: ${e.message}&quot;)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Preview(showBackground = true)&#10;@Composable&#10;fun SocketTestPreview() {&#10;    AirSyncTheme {&#10;        SocketTestScreen()&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>